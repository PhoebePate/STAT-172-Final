# STAT 172 Final Project
# erika, phoebe, kaitlyn
rm(list = ls())
# STAT 172 Final Project
# erika, phoebe, kaitlyn
rm(list = ls())
# STAT 172 Final Project
# erika, phoebe, kaitlyn
rm(list = ls())
library(ggplot2)
library(tidyverse)
library(rpart)
library(rpart.plot)
library(tidyverse)
library(pROC)
library(tidymodels)
library(randomForest)
library(RColorBrewer)
library(glmnet)
library(lubridate)
library(reshape2)
library(stringr)
games <- read.csv("boardgames.csv", stringsAsFactors = TRUE)
games <- read.csv("boardgames1.csv", stringsAsFactors = TRUE)
games <- read.csv("/src/boardgames1.csv", stringsAsFactors = TRUE)
setwd("~/Desktop/STAT 172/GitHub/STAT-172-Final/src")
games <- read.csv("boardgames1.csv", stringsAsFactors = TRUE)
games %>% str()
# CLEANING STEPS
# remove unwanted columns
games <- games %>% select(-c(1, 4, 10:12, 15, 17:18, 20:22, 25, 30, 32, 34, 37:45, 47:50, 52))
# turn description into word count
games$description <- as.character(games$description)
games$desc_word_count <- lengths(strsplit(games$description, "\\s+"))
games <- games %>% select(-description)
# replace minplayers == 0 with median
yearmed <- median(games$yearpublished)
games$yearpublished[games$yearpublished <= 0] <- yearmed
# replace minplayers == 0 with median
minplaymed <- median(games$minplayers)
games$minplayers[games$minplayers == 0] <- minplaymed
# replace maxplayers == 0 with median
maxplaymed <- median(games$maxplayers)
games$maxplayers[games$maxplayers == 0] <- maxplaymed
# replace minplaytime == 0 with median
mintimemed <- median(games$minplaytime)
games$minplaytime[games$minplaytime == 0] <- mintimemed
# replace maxplaytime == 0 with median
maxtimemed <- median(games$maxplaytime)
games$maxplaytime[games$maxplaytime == 0] <- maxtimemed
games$dif_players <- (games$maxplayers - games$minplayers)
# -- boardgamecategory column --
# find count of how many times each unique category appears
cleaned_lists <- str_replace_all(games$boardgamecategory, "\\[|\\]|'", "")
split_lists <- str_split(cleaned_lists, ",\\s*")
unique_items <- unique(unlist(split_lists))
category_counts <- table(unlist(split_lists))
sort(category_counts,decreasing=TRUE)[1:20]
# assign one of the top categories to each row (otherwise "other" category):
top_cats <- c(
"Card Game",
"Wargame",
"Fantasy",
"Party Game",
"Dice",
"Fighting",
"Abstract Strategy",
"Childrens Game",
"Science Fiction"
)
# assign category to each row
assigned_category <- sapply(split_lists, function(x) { # go through each row’s list of categories one by one, call it x
match_cat <- intersect(x, top_cats) # find which of the row’s categories are in your list of top categories.
ifelse(length(match_cat) > 0, match_cat[1], "Other") # if it found any top categories, use the first one; if not, label it "Other".
})
# create new column for main_category
games$main_category <- assigned_category
games <- games %>% select(-boardgamecategory) # remove original column
# -- average (user rating) column --
# not enough people own the game, so rating shows up as 0
# not many that are 0, so we are just going to remove these few rows
games <- games %>% filter(average != 0)
# -- avgweight (complexity) column --
sum(games$avgweight == 0)
# we are going to remove these rows, since we still have many other board games (rows)
games <- games %>%filter(avgweight != 0)
# final checks for factor categorical, logical values, and no NAs
colSums(is.na(games))
str(games)
games <- games %>% filter(maxplayers >= minplayers)
games <- games %>% filter(maxplaytime >= minplaytime)
games <- games %>% filter(yearpublished >= 1900 & yearpublished <= year(Sys.Date()))
# remove duplicates
games <- games %>% distinct()
# defining target variable
games$difficulty <- ifelse(games$avgweight > 2.5, "Complex", "Simple")
games$difficulty <- as.factor(games$difficulty)
# exploratory analysis!
# look at target
games %>% glimpse() %>% summary()
ggplot(games, aes(difficulty)) +
geom_bar() +
labs(title = "Count of Complex vs Simple Games")
games %>%
select(minplayers, maxplayers, minplaytime, maxplaytime, yearpublished, desc_word_count) %>%
gather() %>%
ggplot(aes(value)) +
geom_histogram(bins = 30) +
facet_wrap(~ key, scales = "free") +
labs(title = "Numeric Variable Distributions")
ggplot(games, aes(difficulty, minplaytime)) +
geom_boxplot() +
labs(title = "Min Playtime by Difficulty")
# histograms
ggplot(data = games) + geom_bar(aes(x = yearpublished, fill = difficulty), position = "fill")
# this one is kinda cool to look at especially looking at years after 1950 and the visual of the graph
# i don't think it really tells us a whole lot but just gives another way to understand the data
ggplot(data = games) + geom_histogram(aes(x = numplays_month, fill = difficulty), position = "fill", binwidth = 150)
# this also gives us a glimpse into the data and the numplays per month and it's interesting to see
# the bands
ggplot(data = games) + geom_histogram(aes(x = numwanting, fill = difficulty), position = "fill", binwidth = 75)
# more plots!
# come back to make colorblindness friendly
# chat helped to make pretty for now
# see relationship between difficulty and numwanting
ggplot(games, aes(x = difficulty, y = numwanting, color = difficulty)) +
geom_boxplot(alpha = 0.6) +
theme_minimal() + scale_y_log10()
# see relationship between difficulty and numplays
ggplot(games, aes(x = numplays, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
ggplot(games, aes(x = numplays_month, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
# year published
ggplot(games, aes(x = yearpublished, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
# curious about scatterplot with target and podcast
ggplot(games, aes(x = podcast, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
# curious about scatterplot with target and news
ggplot(games, aes(x = news, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
# -- Multivariate plots of x var and y var ---
ggplot(data = games) + geom_histogram(aes(x= minplaytime, fill = difficulty), position = "fill")
ggsave("output/plotname.pdf")
# -- Multivariate plots of x var and y var ---
ggplot(data = games) + geom_histogram(aes(x= minplaytime, fill = difficulty), position = "fill")
ggsave("output/hist of minplaytime.pdf")
getwd()
setwd("~/Desktop/STAT 172/GitHub/STAT-172-Final")
setwd("~/Desktop/STAT 172/GitHub/STAT-172-Final")
getwd()
games <- read.csv("/data/boardgames1.csv", stringsAsFactors = TRUE)
games <- read.csv("data/boardgames1.csv", stringsAsFactors = TRUE)
(aes(x= minplaytime, fill = difficulty), position = "fill")
# -- Multivariate plots of x var and y var ---
ggplot(data = games) + geom_histogram(aes(x= minplaytime, fill = difficulty), position = "fill")
ggsave("output/hist of minplaytime.pdf")
# STAT 172 Final Project
# erika, phoebe, kaitlyn
rm(list = ls())
library(ggplot2)
library(tidyverse)
library(rpart)
library(rpart.plot)
library(tidyverse)
library(pROC)
library(tidymodels)
library(randomForest)
library(RColorBrewer)
library(glmnet)
library(lubridate)
library(reshape2)
library(stringr)
games <- read.csv("data/boardgames1.csv", stringsAsFactors = TRUE)
games %>% str()
# CLEANING STEPS
# remove unwanted columns
games <- games %>% select(-c(1, 4, 10:12, 15, 17:18, 20:22, 25, 30, 32, 34, 37:45, 47:50, 52))
# turn description into word count
games$description <- as.character(games$description)
games$desc_word_count <- lengths(strsplit(games$description, "\\s+"))
games <- games %>% select(-description)
# replace minplayers == 0 with median
yearmed <- median(games$yearpublished)
games$yearpublished[games$yearpublished <= 0] <- yearmed
# replace minplayers == 0 with median
minplaymed <- median(games$minplayers)
games$minplayers[games$minplayers == 0] <- minplaymed
# replace maxplayers == 0 with median
maxplaymed <- median(games$maxplayers)
games$maxplayers[games$maxplayers == 0] <- maxplaymed
# replace minplaytime == 0 with median
mintimemed <- median(games$minplaytime)
games$minplaytime[games$minplaytime == 0] <- mintimemed
# replace maxplaytime == 0 with median
maxtimemed <- median(games$maxplaytime)
games$maxplaytime[games$maxplaytime == 0] <- maxtimemed
games$dif_players <- (games$maxplayers - games$minplayers)
# -- boardgamecategory column --
# find count of how many times each unique category appears
cleaned_lists <- str_replace_all(games$boardgamecategory, "\\[|\\]|'", "")
split_lists <- str_split(cleaned_lists, ",\\s*")
unique_items <- unique(unlist(split_lists))
category_counts <- table(unlist(split_lists))
sort(category_counts,decreasing=TRUE)[1:20]
# assign one of the top categories to each row (otherwise "other" category):
top_cats <- c(
"Card Game",
"Wargame",
"Fantasy",
"Party Game",
"Dice",
"Fighting",
"Abstract Strategy",
"Childrens Game",
"Science Fiction"
)
# assign category to each row
assigned_category <- sapply(split_lists, function(x) { # go through each row’s list of categories one by one, call it x
match_cat <- intersect(x, top_cats) # find which of the row’s categories are in your list of top categories.
ifelse(length(match_cat) > 0, match_cat[1], "Other") # if it found any top categories, use the first one; if not, label it "Other".
})
# create new column for main_category
games$main_category <- assigned_category
games <- games %>% select(-boardgamecategory) # remove original column
# -- average (user rating) column --
# not enough people own the game, so rating shows up as 0
# not many that are 0, so we are just going to remove these few rows
games <- games %>% filter(average != 0)
# -- avgweight (complexity) column --
sum(games$avgweight == 0)
# we are going to remove these rows, since we still have many other board games (rows)
games <- games %>%filter(avgweight != 0)
# final checks for factor categorical, logical values, and no NAs
colSums(is.na(games))
str(games)
games <- games %>% filter(maxplayers >= minplayers)
games <- games %>% filter(maxplaytime >= minplaytime)
games <- games %>% filter(yearpublished >= 1900 & yearpublished <= year(Sys.Date()))
# remove duplicates
games <- games %>% distinct()
# defining target variable
games$difficulty <- ifelse(games$avgweight > 2.5, "Complex", "Simple")
games$difficulty <- as.factor(games$difficulty)
# exploratory analysis!
# look at target
games %>% glimpse() %>% summary()
ggplot(games, aes(difficulty)) +
geom_bar() +
labs(title = "Count of Complex vs Simple Games")
games %>%
select(minplayers, maxplayers, minplaytime, maxplaytime, yearpublished, desc_word_count) %>%
gather() %>%
ggplot(aes(value)) +
geom_histogram(bins = 30) +
facet_wrap(~ key, scales = "free") +
labs(title = "Numeric Variable Distributions")
ggplot(games, aes(difficulty, minplaytime)) +
geom_boxplot() +
labs(title = "Min Playtime by Difficulty")
# histograms
ggplot(data = games) + geom_bar(aes(x = yearpublished, fill = difficulty), position = "fill")
# this one is kinda cool to look at especially looking at years after 1950 and the visual of the graph
# i don't think it really tells us a whole lot but just gives another way to understand the data
ggplot(data = games) + geom_histogram(aes(x = numplays_month, fill = difficulty), position = "fill", binwidth = 150)
# this also gives us a glimpse into the data and the numplays per month and it's interesting to see
# the bands
ggplot(data = games) + geom_histogram(aes(x = numwanting, fill = difficulty), position = "fill", binwidth = 75)
# more plots!
# come back to make colorblindness friendly
# chat helped to make pretty for now
# see relationship between difficulty and numwanting
ggplot(games, aes(x = difficulty, y = numwanting, color = difficulty)) +
geom_boxplot(alpha = 0.6) +
theme_minimal() + scale_y_log10()
# see relationship between difficulty and numplays
ggplot(games, aes(x = numplays, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
ggplot(games, aes(x = numplays_month, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
# year published
ggplot(games, aes(x = yearpublished, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
# curious about scatterplot with target and podcast
ggplot(games, aes(x = podcast, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
# curious about scatterplot with target and news
ggplot(games, aes(x = news, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
# -- Multivariate plots of x var and y var ---
ggplot(data = games) + geom_histogram(aes(x= minplaytime, fill = difficulty), position = "fill")
ggsave("output/hist of minplaytime.pdf")
games %>%
select(minplayers, maxplayers, minplaytime, maxplaytime, yearpublished, desc_word_count) %>%
gather() %>%
ggplot(aes(value)) +
geom_histogram(bins = 30) +
facet_wrap(~ key, scales = "free") +
labs(title = "Numeric Variable Distributions")
ggsave("output/Numeric Variable Distributions.pdf")
games %>%
select(minplayers, maxplayers, minplaytime, maxplaytime, yearpublished, desc_word_count) %>%
gather() %>%
ggplot(aes(value)) +
geom_histogram(bins = 30) +
facet_wrap(~ key, scales = "free") +
labs(title = "Numeric Variable Distributions")
ggsave("output/Numeric Variable Distributions.pdf")
ggplot(games, aes(difficulty, minplaytime)) +
geom_boxplot() +
labs(title = "Min Playtime by Difficulty")
ggsave("output/Min Playtime by Difficulty.pdf")
# histograms
ggplot(data = games) + geom_bar(aes(x = yearpublished, fill = difficulty), position = "fill")
ggsave("output/Year Published Difficulty.pdf")
# this one is kinda cool to look at especially looking at years after 1950 and the visual of the graph
# i don't think it really tells us a whole lot but just gives another way to understand the data
ggplot(data = games) + geom_histogram(aes(x = numplays_month, fill = difficulty), position = "fill", binwidth = 150)
ggsave("output/Num Plays per Month Difficulty Hist.pdf")
# this also gives us a glimpse into the data and the numplays per month and it's interesting to see
# the bands
ggplot(data = games) + geom_histogram(aes(x = numwanting, fill = difficulty), position = "fill", binwidth = 75)
ggsave("output/Num Wanting Difficulty Hist.pdf")
# more plots!
# come back to make colorblindness friendly
# chat helped to make pretty for now
# see relationship between difficulty and numwanting
ggplot(games, aes(x = difficulty, y = numwanting, color = difficulty)) +
geom_boxplot(alpha = 0.6) +
theme_minimal() + scale_y_log10()
ggsave("output/ Num Wanting Difficulty Boxplot.pdf")
# see relationship between difficulty and numplays
ggplot(games, aes(x = numplays, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
ggsave("output/ Num Plays Difficulty.pdf")
ggplot(games, aes(x = numplays_month, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
ggsave("output/ Num Plays per Month Difficulty.pdf")
# year published
ggplot(games, aes(x = yearpublished, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
ggsave("output/ Year Publish Difficulty.pdf")
# curious about scatterplot with target and podcast
ggplot(games, aes(x = podcast, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
ggsave("output/ Podcast Difficulty.pdf")
# curious about scatterplot with target and news
ggplot(games, aes(x = news, y = difficulty, color = difficulty)) +
geom_point(alpha = 0.6) +
theme_minimal()
ggsave("output/ News Difficulty.pdf")
# -- Multivariate plots of x var and y var ---
ggplot(data = games) + geom_histogram(aes(x= minplaytime, fill = difficulty), position = "fill")
ggsave("output/hist of minplaytime.pdf")
ggplot(data = games) +
geom_bar(aes(x = numplays_month, fill = difficulty), position = "fill") +
facet_wrap(~average) + ggtitle("Effect of Plays, Difficulty") +
labs( x = "Plays per Month", y = "Proportion") + scale_fill_grey("Board Game\nOoutcome") + theme_bw()
ggplot(data = games) +
geom_point(aes(x = desc_word_count, y = numwanting, colour = difficulty)) +scale_colour_grey() + theme_bw()
ggsave("output/ Word Count Difficulty.pdf")
library(RColorBrewer) #color palettes
#Recall that black/white color palettes are always colorblind friendly.
#Alternatively: RColorBrewer provides many colorblind friendly palettes to choose from
#See the choices:
display.brewer.all(colorblindFriendly = T)
#see:
?scale_colour_brewer
#clarity if sequential (I1 worst, IF best)
# ---> try a sequential palette (always CB friendly, actually)
ggplot(data = diamonds) +
geom_point(aes(carat, price,colour = clarity))+
scale_colour_brewer("Clarity", palette = "BuPu")
#but if you were coloring by something non-sequential,
#you might choose a categorical palette instead
ggplot(diamonds) +
geom_point(aes(carat, price,colour = color))+
scale_colour_brewer("Color", palette = "Dark2")
# exploratory analysis!
# look at target
games %>% glimpse() %>% summary()
ggplot(games, aes(difficulty)) +
geom_bar() +
labs(title = "Count of Complex vs Simple Games")
library(RColorBrewer) #color palettes
#Recall that black/white color palettes are always colorblind friendly.
#Alternatively: RColorBrewer provides many colorblind friendly palettes to choose from
#See the choices:
display.brewer.all(colorblindFriendly = T)
# exploratory analysis!
# look at target
games %>% glimpse() %>% summary()
ggplot(games, aes(difficulty)) +
geom_bar(fill = "Dark2") +
labs(title = "Count of Complex vs Simple Games")
# STAT 172 Final Project
# erika, phoebe, kaitlyn
rm(list = ls())
library(ggplot2)
library(tidyverse)
library(rpart)
library(rpart.plot)
library(tidyverse)
library(pROC)
library(tidymodels)
library(randomForest)
library(RColorBrewer)
library(glmnet)
library(lubridate)
library(reshape2)
library(stringr)
games <- read.csv("data/boardgames1.csv", stringsAsFactors = TRUE)
games %>% str()
# CLEANING STEPS
# remove unwanted columns
games <- games %>% select(-c(1, 4, 10:12, 15, 17:18, 20:22, 25, 30, 32, 34, 37:45, 47:50, 52))
# turn description into word count
games$description <- as.character(games$description)
games$desc_word_count <- lengths(strsplit(games$description, "\\s+"))
games <- games %>% select(-description)
# replace minplayers == 0 with median
yearmed <- median(games$yearpublished)
games$yearpublished[games$yearpublished <= 0] <- yearmed
# replace minplayers == 0 with median
minplaymed <- median(games$minplayers)
games$minplayers[games$minplayers == 0] <- minplaymed
# replace maxplayers == 0 with median
maxplaymed <- median(games$maxplayers)
games$maxplayers[games$maxplayers == 0] <- maxplaymed
# replace minplaytime == 0 with median
mintimemed <- median(games$minplaytime)
games$minplaytime[games$minplaytime == 0] <- mintimemed
# replace maxplaytime == 0 with median
maxtimemed <- median(games$maxplaytime)
games$maxplaytime[games$maxplaytime == 0] <- maxtimemed
games$dif_players <- (games$maxplayers - games$minplayers)
# -- boardgamecategory column --
# find count of how many times each unique category appears
cleaned_lists <- str_replace_all(games$boardgamecategory, "\\[|\\]|'", "")
split_lists <- str_split(cleaned_lists, ",\\s*")
unique_items <- unique(unlist(split_lists))
category_counts <- table(unlist(split_lists))
sort(category_counts,decreasing=TRUE)[1:20]
# assign one of the top categories to each row (otherwise "other" category):
top_cats <- c(
"Card Game",
"Wargame",
"Fantasy",
"Party Game",
"Dice",
"Fighting",
"Abstract Strategy",
"Childrens Game",
"Science Fiction"
)
# assign category to each row
assigned_category <- sapply(split_lists, function(x) { # go through each row’s list of categories one by one, call it x
match_cat <- intersect(x, top_cats) # find which of the row’s categories are in your list of top categories.
ifelse(length(match_cat) > 0, match_cat[1], "Other") # if it found any top categories, use the first one; if not, label it "Other".
})
# create new column for main_category
games$main_category <- assigned_category
games <- games %>% select(-boardgamecategory) # remove original column
# -- average (user rating) column --
# not enough people own the game, so rating shows up as 0
# not many that are 0, so we are just going to remove these few rows
games <- games %>% filter(average != 0)
# -- avgweight (complexity) column --
sum(games$avgweight == 0)
# we are going to remove these rows, since we still have many other board games (rows)
games <- games %>%filter(avgweight != 0)
# final checks for factor categorical, logical values, and no NAs
colSums(is.na(games))
str(games)
nrow(games)
games <- games %>% filter(maxplayers >= minplayers)
games <- games %>% filter(maxplaytime >= minplaytime)
games <- games %>% filter(yearpublished >= 1850 & yearpublished <= year(Sys.Date()))
nrow(games)
games <- games %>% filter(maxplayers >= minplayers)
games <- games %>% filter(maxplaytime >= minplaytime)
games <- games %>% filter(yearpublished >= 1900 & yearpublished <= year(Sys.Date()))
nrow(games)
games <- games %>% filter(yearpublished >= 1850 & yearpublished <= year(Sys.Date()))
nrow(games)
games <- games %>% filter(maxplayers >= minplayers)
games <- games %>% filter(maxplaytime >= minplaytime)
games <- games %>% filter(yearpublished >= 2000 & yearpublished <= year(Sys.Date()))
nrow(games)
