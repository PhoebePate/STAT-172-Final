rm(list = ls())
# load packages
library(ggplot2)
library(tidyverse)
library(rpart)
library(rpart.plot)
library(pROC)
library(tidymodels)
library(randomForest)
library(RColorBrewer)
library(glmnet)
library(lubridate)
library(reshape2)
library(stringr)
# import data
games <- read.csv("src/boardgames.csv", stringsAsFactors = TRUE)
# remove unwanted columns
games <- games %>% select(-c(1, 4, 10:13, 15, 17:18, 20:22, 25, 30, 32, 34, 37:45, 47:50, 52))
source("STAT-172-Final/src/Board Games Data Cleaning.R") # sourcing the dataframe from
source("src/Board Games Data Cleaning.R") # sourcing the dataframe from
games_clean <- source("src/Board Games Data Cleaning.R") # sourcing the dataframe from
games_clean <- read.csv("src/cleanboardgames.csv")
games_clean <- games_clean %>% select(-c(1,2,10,23))
RNGkind(sample.kind = "default")
set.seed(2291352)
train.idx <- sample(x = 1:nrow(games_clean), size = 0.8*nrow(games_clean))
# create training data
train.df <- games_clean[train.idx,]
# create testing data
test.df <- games_clean[-train.idx,]
set.seed(172172172)
games_tree <- rpart(difficulty ~ .,
data = train.df,
method = 'class')
# plot our tree
rpart.plot(games_tree)
levels(train.df$difficulty)
printcp(games_tree)
set.seed(172172172)
games_tree <- rpart(difficulty ~ ., # assumes you want ALL OTHER COLUMNS AS PREDICTORS
data = train.df,
method = 'class',
control = rpart.control(cp = 0.0001, minsplit = 1))
rpart.plot(games_tree)
# prune it
printcp(games_tree)
optimalcp <- games_tree$cptable[which.min(games_tree$cptable[,"xerror"]),"CP"]
games_tree2 <- prune(games_tree,cp = optimalcp)
rpart.plot(games_tree2)
optimalcp <- games_tree$cptable[which.min(games_tree$cptable[,"xerror"]),"CP"]
games_tree2 <- prune(games_tree,cp = optimalcp)
library(rpart) # classification trees
library(rpart.plot) # makes pretty trees
library(tidyverse)
library(pROC)
games_clean <- read.csv("src/cleanboardgames.csv")
games_clean <- games_clean %>% select(-c(1,2,10,23))
RNGkind(sample.kind = "default")
set.seed(2291352)
train.idx <- sample(x = 1:nrow(games_clean), size = 0.8*nrow(games_clean))
# create training data
train.df <- games_clean[train.idx,]
# create testing data
test.df <- games_clean[-train.idx,]
set.seed(172172172)
games_tree <- rpart(difficulty ~ .,
data = train.df,
method = 'class')
# plot our tree
rpart.plot(games_tree)
levels(train.df$difficulty)
View(train.df)
